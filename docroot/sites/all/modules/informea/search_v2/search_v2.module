<?php
/**
 * @file
 * Code for the Search V2 feature.
 */

include_once 'search_v2.features.inc';

/**
 * Implements hook_entity_info_alter().
 */
function search_v2_entity_info_alter(&$entity_info) {
  $entity_info['node']['view modes']['search_item'] = array(
    'label' => t('Search item'),
    'custom settings' => TRUE,
  );
}

/**
 * Implements hook_facet_items_alter().
 */
function search_v2_facet_items_alter(&$build, &$settings) {
  switch ($settings->name) {
    case 'search_api@default_index:block:field_region':
      foreach ($build as $key => $item) {
        if ($key == '!') {
          $build[$key]['#markup'] = sprintf('%s <span class="item-label">%s</span>', t('In'), t('All Regions'));
        }
        else {
          $build[$key]['#markup'] = sprintf('%s <span class="item-label">%s</span>', t('only in'), $build[$key]['#markup']);
        }
        $build[$key]['#html'] = TRUE;
      }
      break;
  }
}
